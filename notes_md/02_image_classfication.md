# 图像分类

前面已经提过，**图像分类就是让算法接收一张图作为输入，并且有一些固定分类标签的集合，从固定的类别集合中选出该图像所属的类别。**图像分类是一个计算机视觉中的核心任务。这对于人类来说很简单，因为人类大脑里的视觉系统天生就是来做这些视觉识别任务，但是**对于一台机器来说真的是一个非常非常困难的问题**。

## 计算机图像分类难点

### 语义鸿沟

当一个计算机看着这些图片的时候，它看到的是什么？它没有一只猫咪这样的的整体概念，计算机呈现图片的方式其实就是数字，举例来说，下面这幅图就是800*600的像素，每一个像素由三个数字表示分别对应红、绿、蓝三个值。所以对于计算机来说，图像就是一个巨大的数字阵列，**很难从中提取猫咪的特性**，我们把这个问题称为**语义鸿沟**。

![image-20220510105538172](https://raw.githubusercontent.com/verfallen/gallery/master/cs231n-2017-notes/image-20220510105538172.png)

### 视觉偏差

如果稍微改变一下图片，整个像素网格都会发生变化。比如还是同一样一只猫静坐着，如果我们把相机移动到另一边，那么这个巨大的像素网格中的每一个像素都会完全不同，但是它仍然代表着同样一只猫，同时我们的算法需要对这些变化鲁棒。

### 照明

场景中会有不同的照明条件，无论猫咪出现在怎样样的漆黑、皆暗的场景中，我们的算法也应该是鲁棒的。

![image-20220510105912679](https://raw.githubusercontent.com/verfallen/gallery/master/cs231n-2017-notes/image-20220510105912679.png)



### 变形

目标对象有时还会变形，比如猫咪可以有干奇百怪的姿势和位置，对于不同的形变情形我们的算法也应该是鲁棒的。

![image-20220510112200631](https://raw.githubusercontent.com/verfallen/gallery/master/cs231n-2017-notes/image-20220510112200631.png)

### 遮挡

也可能有遮挡的问题，比如可能仅看到猫咪的一部分,比如说脸甚至只看到尾巴尖儿从沙发垫下露出。我们的算法需要鲁棒地应对的一种情况

![image-20220510112428446](https://raw.githubusercontent.com/verfallen/gallery/master/cs231n-2017-notes/image-20220510112428446.png)

### 背景混乱

处理的时候还会有图片背景混乱的问题，比如可能一张图片的前面所显示的是一只猫，但是可能猫身上的纹理会和背景十分相似。

<img src="https://raw.githubusercontent.com/verfallen/gallery/master/cs231n-2017-notes/image-20220510112633063.png" alt="image-20220510112633063" style="zoom:67%;" />

### 类内差异

这张图看上去是一些猫但实际上每只猫都有视觉上的差异。猫有不同的外形、大小，颜色以及年龄。算法需要鲁棒地处理这些不同场景。

![image-20220510112716960](https://raw.githubusercontent.com/verfallen/gallery/master/cs231n-2017-notes/image-20220510112716960.png)

# 硬编码图像识别方法

对于猫来说，我们知道猫有耳朵、眼睛、嘴巴、鼻子。根据 Hubel 和 Wiesel 的研究我们了解到边缘对于视觉识别是十分重要的。所以我们可以尝试计算出图像的边缘，然后把边、角各种形状分类好，比如有三条线是这样相交的那这就可能是一个角点，比如猫耳朵有这样那样的角，诸如此类我们可以写一些规则来识别这些猫。

但是实际上呢这种算法并不是很好，有以下缺点：

+ 正确率不高，很容易出错
+ 不可拓展，如果已经有了一个猫的分类器，想要对另一种对象进行分类，需要重新制定规则，重新训练。

![image-20220510113356355](https://raw.githubusercontent.com/verfallen/gallery/master/cs231n-2017-notes/image-20220510113356355.png)

# 数据驱动的方法

我们想发明一些识别算法，可以拓展到识别世界上各种对象。基于此我们想到用数据驱动的方法，不写具体的分类规则来识别一只猫或者鱼，取而代之的是**我们从网上抓取数据，比如大量猫的图片数据集，大量飞机的图片数据集等等。有了数据集之后，我们训练机器来分类这些图片，机器会收集所有数据，用某种方式总结**
**然后生成一个模型，总结出识别出对象不同类别的核心方法，然后用这些模型来识别新的图片。**

模型会变成两个函数，一个是训练函数，接收图片和标签，然后输出模型。另一种是预测函数，输入图片，对图片标签进行预测。正是用了这种方法，在过去十几二十年间，图像识别领域的进步非常大。

![image-20220510115921590](https://raw.githubusercontent.com/verfallen/gallery/master/cs231n-2017-notes/image-20220510115921590.png)

